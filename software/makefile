# Define names and versions
ENV_NAME := rover-env
PYTHON_VERSION := 3.12

.PHONY: install conda uninstall activate 

all: install run

###############################################################################
###				  Environment and dependencies installation  				###
###############################################################################
install: conda poetry

conda:
	@echo "\n ðŸš€ Creating Conda environment & installing dependencies ðŸ“¦ \n"
	conda env create -n $(ENV_NAME) -f environment.yml
	bash -i -c "conda activate $(ENV_NAME) && pip install pyfirmata2"
	@echo "âœ… Conda environment created.\n\n"

uninstall:
	@echo "\n ðŸ§¹ Removing Conda environment"
	conda remove -y --name $(ENV_NAME) --all

activate:
	@echo "\n\n ðŸ”§ To activate the environment, use \n"
	@echo "	conda activate $(ENV_NAME)\n\n"


###############################################################################
###				  				Code execution  							###
###############################################################################
run:
run:
	@echo "\n\n ðŸŽ® Starting the controller app ðŸŽ® \n"
	bash -c "source $(shell conda info --base)/etc/profile.d/conda.sh && \
			 conda activate $(ENV_NAME) && \
			 python3 roverCode.py"

